https://colab.research.google.com/drive/1v-J96Iq2zQAwwlHhZa6sHtNq8xRELApQ?usp=sharing 

# -*- coding: utf-8 -*-
"""build_mini_dataset.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1v-J96Iq2zQAwwlHhZa6sHtNq8xRELApQ
"""

import os

os.makedirs("data/raw", exist_ok=True)
os.makedirs("data/metadata", exist_ok=True)
os.makedirs("data/audio", exist_ok=True)

!pwd
!ls

from google.colab import files
uploaded = files.upload()

import pandas as pd
import os

tracks_path = "/content/tracks (1).csv"
tracks = pd.read_csv(tracks_path, header=[0, 1], index_col=0)

# Only use SMALL subset, since that's what fma_small.zip contains
is_small = tracks[('set', 'subset')] == 'small'
tracks_small = tracks[is_small].copy()

print("Total tracks in SMALL subset:", len(tracks_small))

genre_col_small = tracks_small[('track', 'genre_top')]
genre_counts_small = genre_col_small.value_counts()
genre_counts_small.head(30)

MIN_PER_GENRE = 65
MAX_PER_GENRE = 65
RANDOM_STATE = 100

subset = tracks_small[genre_col_small.isin(TARGET_GENRES)].copy()

def sample_group(group):
    n_available = len(group)
    n_desired = min(MAX_PER_GENRE, n_available)
    return group.sample(n=n_desired, random_state=RANDOM_STATE)

sampled = subset.groupby(('track', 'genre_top'), group_keys=False).apply(sample_group)

print("Total sampled tracks:", len(sampled))
print("Counts by genre:")
print(sampled[('track', 'genre_top')].value_counts())

def track_id_to_relpath(track_id: int) -> str:
    tid_str = f"{track_id:06d}"     # e.g. 11778 -> "011778"
    folder = tid_str[:3]            # "011"
    return f"{folder}/{tid_str}.mp3"

sampled = sampled.reset_index()
sampled['track_id'] = sampled['track_id'].astype(int)

sampled['rel_path'] = sampled['track_id'].apply(track_id_to_relpath)
sampled['artist_name'] = sampled[('artist', 'name')]
sampled['track_title'] = sampled[('track', 'title')]

mini_meta = sampled[['track_id', 'rel_path', 'artist_name', 'track_title']].copy()
mini_meta = mini_meta.sort_values('track_id')

os.makedirs("data/metadata", exist_ok=True)

# This is the metadata your repo will use
mini_meta.to_csv("data/metadata/tracks.csv", index=False)

# This is the list youâ€™ll use on your laptop to copy files
mini_meta['rel_path'].to_csv("data/metadata/audio_paths.txt", index=False, header=False)

print("Saved metadata to data/metadata/tracks.csv")
print("Saved paths to data/metadata/audio_paths.txt")
mini_meta.head()

import pandas as pd
import os

tracks_path = "/content/data/metadata/tracks.csv"

tracks = pd.read_csv(tracks_path, index_col=0)

print("Total tracks in sampled subset:", len(tracks))

from google.colab import files
files.download("data/metadata/audio_paths.txt")
